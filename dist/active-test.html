<html><head><meta charset="UTF-8"><template id="active-test">
  <style scoped="">
    .correct {
      color: #060;
    }
    .correct::before {
      content: "✓ ";
    }
    .incorrect {
      color: #900;
    }
    .incorrect::before {
      content: "✗ ";
    }
    .test-desc {
      width: 100%;
    }

    /* http://www.menucool.com/tooltip/css-tooltip */
    .test-desc {outline:none;}
    .test-desc strong {line-height:30px;}
    .test-desc:hover {text-decoration:none;} 
    .test-desc span.test-result {
      z-index: 10;
      display: none;
      padding: 14px 20px;
      margin-top: -30px;
      margin-left: 28px;
      max-width: 400px;
      line-height: 16px;
    }
/*    .test-desc:hover span.test-result {
      display: inline;
      position: absolute;
      color: #111;
      border: 1px solid #DCA;
      background: #fffAF0;
    }
*/
    .active-test:hover .edit {
      display: inline;
    }

    .test-result {
      z-index: 20;
      position: absolute;
      top: 30px;
      border: 0;
      left: -12px;
    }
    .test-desc span.test-result {
      border-radius:4px;
      box-shadow: 5px 5px 8px #CCC;
    }

    .flex-container {
      display: flex;
      justify-content: space-between;
    }

    .edit {
      transform: scale(-1, 1);
      cursor: pointer;
      display: none;
    }

  </style>
  <div class="active-test">
    <div class="flex-container">
      <div class="test-desc incorrect"><span class="test-result"></span></div><a class="edit" onclick="this.edit()">✎</a>
    </div>
  </div>
</template>
<script>
  (function() {
    'use strict';
    var exports = {};

    var importDoc = document.currentScript.ownerDocument;
    var proto = Object.create(HTMLElement.prototype);

    /*
    Called to create the element
    */
    proto.createdCallback = function() {
      var template = importDoc.querySelector('#active-test');
      var clone = document.importNode(template.content, true);
      var root = this.createShadowRoot();
      root.appendChild(clone);
    };

    /*
    This massive function is called when an instance of the element is attached to the page. All of the active_test logic is contained within.
    @param: none
    returns: none
    */
    proto.attachedCallback = function() {
      var testDescription = this.getAttribute('description');
      var testPassed = this.getAttribute('testPassed');

      /*
      Display the test description.
      TODO: put this in a function
      */
      var td = this.shadowRoot.querySelector('.test-desc');
      var tr = this.shadowRoot.querySelector('.test-desc > span');
      td.insertAdjacentHTML('afterbegin', '<span>' + testDescription + '</span>');

      var editButton = this.shadowRoot.querySelector('a.edit');
      console.log(this.edit);
      editButton.edit = this.edit;

      /*
      Just swap the classes
      */
      function testHasPassed() {
        td.classList.remove('incorrect');
        td.classList.add('correct');
      };

      /*
      Just swap the classes
      */
      function testHasFailed() {
        td.classList.add('incorrect');
        td.classList.remove('correct');
      };
    };

    function edit(activeTest) {
      testWidget.editTest(activeTest.testDefinition);
    };
    exports.edit = edit;

    function save (test) {
      // will need to clearInterval(activeTest) and restart it.
    };
    exports.save = save;

    document.registerElement('active-test', {prototype: proto});
    return exports;
  })();
</script></head><body></body></html>