var GE=function(t,e){"use strict";function n(t,e){e=e||document;var n=Array.prototype.slice.apply(e.querySelectorAll(t));return n}function r(t){if("number"==typeof t)return t;if("string"==typeof t)return t.match(/\d+/g)[0];throw new TypeError("Measurement needs to be passed a string or number.")}function o(){this._methods=[],this._flushing=!1,this._blocked=!1}function i(){this.id=parseInt(1e6*Math.random()),this.element=null,this.value=null,this.operation=null,this.children=[],this.index=null,this.correct=!1}function s(){this.questions=[],this.passed=!1}function a(t){this.target=null,this.gradebook=new s,this.operations=[],this.gradeOpposite=!1,this.picky=!1,this.queue=new o,this.description=t}function u(t){if(this.description=t.description,this.flags=t.flags||{},this.id=parseInt(1e6*Math.random()),this.testPassed=!1,this.gradeRunner=function(){},"string"!=typeof this.description)throw new TypeError("Every suite needs a description string.");if("object"!=typeof this.flags)throw new TypeError("If assigned, flags must be an object.");this.iwant=new a(this.description);var e=this;e.queueUp=function(t){var n=e.iwant._translateConfigToMethods(t);return function(){n.forEach(function(t){t()})}}(t.definition)}function c(t){var e=t.name,n=t.code,r=parseInt(1e6*Math.random());if("string"!=typeof e)throw new TypeError("Every suite needs a name string.");if("string"!=typeof n)throw new TypeError("Every suite needs a code string.");this.name=e,this.code=n,this.activeTests=[],this.id=r,this.suitePassed=!1}function h(t){function e(t){return r.createTest({description:t.description,definition:t.definition,flags:t.flags}),n}var n=this,r=v.createSuite(t);return{registerTest:e}}function l(t){try{m=JSON.parse(t)}catch(e){throw new TypeError("Invalid JSON format."+e)}b.on&&d()}function f(){b.on||(testWidget.buildWidget(),b.on=!0)}function d(){m.forEach(function(t){var e=h({name:t.name,code:t.code});t.tests.forEach(function(t){e.registerTest({description:t.description,definition:t.definition,flags:t.flags})})})}function p(){v.occupiedSuites.forEach(function(t){t.activeTests.forEach(function(t){t.stopTest()})}),v.occupiedSuites=[],testWidget.killWidget(),b.on=!1}var g={};Function.prototype.getBody=function(){var t=this.toString().match(/\{([\s\S]*)\}/m)[1];return t=t.replace(/([^"]+)|("[^"]+")/g,function(t,e,n){return e?e.replace(/\s/g,""):n}),t.replace(/^\s*\/\/.*$/gm,"")},o.prototype={add:function(t){this._methods.push(t),this._flushing||this._blocked||this.step()},clear:function(){this._flushing=!1,this._methods=[]},step:function(){function t(t){return new Promise(function(n,r){if(t)try{var o=t()}catch(i){e.block()}n(o)})}var e=this;this._flushing||(this._flushing=!0),this._blocked||t(this._methods.shift()).then(function(t){e._methods.length>0&&e.step()})},block:function(){this._blocked=!0},unblock:function(){this._blocked=!1,this.step()}},Object.defineProperties(i.prototype,{hasChildren:{get:function(){var t=!1;return this.children.length>0&&(t=!0),t}},hasValue:{get:function(){var t=!1;return null!==this.value&&this.value!==e&&(t=!0),t}},hasGrandkids:{get:function(){var t=!1;return t=this.children.some(function(t){return t.hasChildren})}}}),Object.defineProperties(s.prototype,{numberOfQuestions:{get:function(){return this.questions.length}},numberCorrectQuestions:{get:function(){var t=0;return this.questions.forEach(function(e){e.correct&&(t+=1)}),t}},allCorrect:{get:function(){var t=!1;return this.numberOfQuestions===this.numberCorrectQuestions&&this.numberOfQuestions>0&&(t=!0),t}},numberWrongQuestions:{get:function(){var t=0;return t=numberOfQuestions-numberCorrectQuestions}},report:{get:function(){return{isCorrect:this.passed,questions:this.questions}}}}),s.prototype.recordQuestion=function(t){t.correct=!1,this.questions.push(t)},s.prototype.reset=function(){this.questions=[],this.passed=!1},s.prototype.grade=function(t){var e,n,r;switch(e=t.strictness,n=t.not,r=t.callback,this.questions.forEach(function(t){t.correct=r(t),n&&(t.correct=!t.correct)}),e){case"someOf":this.numberCorrectQuestions<this.numberOfQuestions&&this.numberCorrectQuestions>0&&(this.passed=!0);break;case"onlyOneOf":1===this.numberCorrectQuestions&&(this.passed=!0);break;default:this.passed=this.allCorrect}return 0===this.numberOfQuestions&&n&&(this.passed=!this.passed),this.report},Object.defineProperties(a.prototype,{childPosition:{get:function(){var t=this;return this.queue.add(function(){t._runAgainstBottomTargets(function(t){var e=t.element,n=null,r=0;return Array.prototype.slice.apply(t.element.parentNode.children).forEach(function(t,o){"#text"===t.nodeName&&(r+=1),t===e&&(n=o-r)}),n})}),this}},count:{get:function(){var t=this;return this.queue.add(function(){t._registerOperation("count"),t._runAgainstNextToBottomTargets(function(t){var e=null;try{e=t.children.length}catch(n){throw console.log(n),new Error}return e})}),this}},index:{get:function(){var t=this;return this.queue.add(function(){t._registerOperation("index"),t._runAgainstBottomTargets(function(t){return t.index})}),this}},innerHTML:{get:function(){var t=this;return this.queue.add(function(){t._registerOperation("innerHTML"),t._runAgainstBottomTargetElements(function(t){var e="";try{e=t.innerHTML}catch(n){throw console.log(n),new Error}return e})}),this}},onlyOneOf:{get:function(){var t=this;return this.queue.add(function(){t.picky="onlyOneOf"}),this}},someOf:{get:function(){var t=this;return this.queue.add(function(){t.picky="someOf"}),this}},_targetIds:{get:function(){var t=[];return this._traverseTargets(function(e){t.push(e.id)}),t}},UAString:{get:function(){var t=this;return this.queue.add(function(){t._registerOperation("gatherElements"),t.target=new i,t._runAgainstTopTargetOnly(function(e){var n="";try{n=navigator.userAgent}catch(r){throw console.log("%cCan't find a user agent string. See "+t.description,"color: red;"),new Error}return n})}),this}}}),a.prototype.onresult=function(t){},a.prototype._registerOperation=function(t){this.operations.push(t),this.gradebook.reset()},a.prototype._traverseTargets=function(t){function e(t,n){n&&n(t),t.children.forEach(function(t,r,o){e(t,n)})}e(this.target,t)},a.prototype._runAgainstTopTargetOnly=function(t){var e=this;this.target.value=t(this.target),this.target.value?e.gradebook.recordQuestion(this.target):this.target.children.forEach(function(t){e.gradebook.recordQuestion(t)})},a.prototype._runAgainstBottomTargets=function(t){var e=this,n=this._targetIds;this._traverseTargets(function(r){!r.hasChildren&&n.indexOf(r.id)>-1&&(r.value=t(r),r.value?e.gradebook.recordQuestion(r):r.children.forEach(function(t){e.gradebook.recordQuestion(t)}))})},a.prototype._runAgainstBottomTargetElements=function(t){var e=this,n=this._targetIds;this._traverseTargets(function(r){!r.hasChildren&&n.indexOf(r.id)>-1&&(r.value=t(r.element),r.value?e.gradebook.recordQuestion(r):r.children.forEach(function(t){e.gradebook.recordQuestion(t)}))})},a.prototype._runAgainstNextToBottomTargets=function(t){var e=this;this._traverseTargets(function(n){n.hasChildren&&!n.hasGrandkids&&(n.value=t(n),n.value?e.gradebook.recordQuestion(n):n.children.forEach(function(t){e.gradebook.recordQuestion(t)}))})},a.prototype.theseElements=function(t){var e=this;return this.queue.add(function(){e._registerOperation("gatherElements"),e.target=new i,e._runAgainstTopTargetOnly(function(r){var o=n(t);if(0===o.length&&t)throw console.log("%cSelector "+t+" found 0 elements. See "+e.description,"color: red;"),new Error;o.length>0&&o.forEach(function(t,e,n){var o=new i;o.element=t,o.index=e,r.children.push(o)})})}),this},a.prototype.nodes=a.prototype.theseElements,a.prototype.deepChildren=function(t){var e=this;this.queue.add(function(){e._registerOperation("gatherDeepChildElements"),e._runAgainstBottomTargets(function(e){n(t,e.element).forEach(function(t,n){var r=new i;r.element=t,r.index=n,e.children.push(r)})})})},a.prototype.children=a.prototype.deepChildren,a.prototype.get=function(t){var e=this;switch(t){case"count":e.count;break;case"childPosition":e.childPosition;break;case"innerHTML":e.innerHTML;break;case"UAString":e.UAString;break;default:throw new Error("Cannot 'get': "+t+". Options include: 'count', 'childPosition', innerHTML', and 'UAString'.")}},a.prototype.limit=function(t){var e=this;switch(t){case 1:e.onlyOneOf;break;case"some":e.someOf;break;default:throw console.log("%cIllegal 'limit'. Options include: 1 or 'some'. See "+e.description,"color: red;"),new Error}},a.prototype.cssProperty=function(e){var n=this;return this.queue.add(function(){n._registerOperation("cssProperty"),n._runAgainstBottomTargetElements(function(r){var o={},i=null;try{o=t.getComputedStyle(r),i=o[e]}catch(s){throw console.log("%cCannot get CSS property: "+e+". See "+n.description,"color: red;"),new Error}return i})}),this},a.prototype.attribute=function(t){var e=this;return this.queue.add(function(){e._registerOperation("attribute"),e._runAgainstBottomTargetElements(function(n){var r=null;try{r=n.getAttribute(t)}catch(o){throw console.log("%cCannot get attribute "+t+". See "+e.description,"color: red;"),new Error}return""===r&&(r=!0),r})}),this},a.prototype.absolutePosition=function(e){var n=this;return this.queue.add(function(){function r(e){var n=e.currentStyle||t.getComputedStyle(e,"");return n.display}n._registerOperation("absolutePosition");var o=function(){};switch(e){case"top":var o=function(t){var n=r(t),o=NaN;return"block"===n?o=t.offsetTop:"inline"===n&&(o=t.getBoundingClientRect()[e]),o};break;case"left":var o=function(t){var n=r(t),o=NaN;return"block"===n?o=t.offsetLeft:"inline"===n&&(o=t.getBoundingClientRect()[e]),o};break;case"bottom":var o=function(n){var o=r(n),i=NaN;return"block"===o?i=n.offsetTop+n.offsetHeight:"inline"===o&&(i=n.getBoundingClientRect()[e]),i===Math.max(document.documentElement.clientHeight,t.innerHeight||0)&&(i="max"),i};break;case"right":var o=function(n){var o=r(n),i=NaN;return"block"===o?i=n.offsetLeft+n.offsetWidth:"inline"===o&&(i=n.getBoundingClientRect()[e]),i===Math.max(document.documentElement.clientWidth,t.innerWidth||0)&&(i="max"),i};break;default:o=function(){return console.log("You didn't pick a side for absolutePosition! Options are 'top', 'left', 'bottom' and 'right'."),NaN}}n._runAgainstBottomTargetElements(function(t){var r=null;try{r=o(t)}catch(i){throw console.log("%cCannot get absolute position of "+e+". See "+n.description,"color: red;"),new Error}return r})}),this},a.prototype.waitForEvent=function(e){var n=this;return n.queue.block(),t.addEventListener(e,function(t){n.queue.unblock(),n._runAgainstTopTargetOnly(function(e){return t.detail})}),this.queue.add(function(){n._registerOperation("gatherElements"),n.target=new i}),this},a.prototype.exists=function(t){var e=this;t===!1&&"boolean"==typeof t&&e.not(!0),this.queue.add(function(){var t=e.operations[e.operations.length-1],n=function(){};switch(t){case"gatherElements":n=function(t){var e=!1;return(t.children.length>0||t.element||t.value)&&(e=!0),e};break;case"gatherDeepChildElements":n=function(t){var e=!1;return t.element&&(e=!0),e};break;default:n=function(t){var e=!1;return(t.value||t.element)&&(e=!0),e}}var r=e.gradebook.grade({callback:n,not:e.gradeOpposite,strictness:e.picky});e.onresult(r)})},a.prototype.not=function(t){var e=this;"boolean"!=typeof t&&(t=!0),this.queue.add(function(){t&&(e.gradeOpposite=!0)})},a.prototype.equals=function(t){var e=this;this.queue.add(function(){var n,r;if("object"==typeof t?(n=t.expected,r=t.noStrict||!1):n=t,!n)throw console.log("%c'equals' needs a value. See "+e.description,"color: red;"),new Error;var o=function(){};switch(r){case!0:o=function(t){return t.value==n};break;case!1:o=function(t){return t.value===n};break;default:o=function(t){return t.value===n}}var i=e.gradebook.grade({callback:o,not:e.gradeOpposite,strictness:e.picky});e.onresult(i)})},a.prototype.isGreaterThan=function(t){var e=this;this.queue.add(function(){var n=t.expected||t,o=t.orEqualTo||!1;if(!n)throw console.log("%c'isGreaterThan' needs a value. See "+e.description,"color: red;"),new Error;var i=function(){};switch(o){case!0:i=function(t){var e=!1;return r(t.value)>=r(n)&&(e=!0),e};break;default:i=function(t){var e=!1;return r(t.value)>r(n)&&(e=!0),e}}var s=e.gradebook.grade({callback:i,not:e.gradeOpposite,strictness:e.picky});e.onresult(s)})},a.prototype.isLessThan=function(t){var e=this;this.queue.add(function(){var n=t.expected||t,o=t.orEqualTo||!1;if(!n)throw console.log("%c'isLessThan' needs a value. See "+e.description,"color: red;"),new Error;var i=function(){};switch(o){case!0:i=function(t){var e=!1;return r(t.value)<=r(n)&&(e=!0),e};break;default:i=function(t){var e=!1;return r(t.value)<r(n)&&(e=!0),e}}var s=e.gradebook.grade({callback:i,not:e.gradeOpposite,strictness:e.picky});e.onresult(s)})},a.prototype.isInRange=function(t){var e=this;this.queue.add(function(){var n=r(t.lower),o=r(t.upper),i=t.lowerInclusive||!0,s=t.upperInclusive||!0;if(n>o){var a=n;n=o,o=a}if("number"!=typeof n||"number"!=typeof o)throw console.log("%c'isInRange' needs an upper and a lower value in its config object. See "+e.description,"color: red;"),new Error;var u=function(){};switch(s){case!0:u=function(t){var e=!1;return r(t.value)<=r(o)&&(e=!0),e};break;default:u=function(t){var e=!1;return r(t.value)<r(o)&&(e=!0),e}}var c=function(){};switch(i){case!0:c=function(t){var e=!1;return r(t.value)>=r(n)&&(e=!0),e};break;default:c=function(t){var e=!1;return r(t.value)>r(n)&&(e=!0),e}}var h=function(t){var e=!1;return u(t)&&c(t)&&(e=!0),e},l=e.gradebook.grade({callback:h,not:e.gradeOpposite,strictness:e.picky});e.onresult(l)})},a.prototype.hasSubstring=function(t){var e=this;this.queue.add(function(){t=t||{};var n=t.expectedValues;if(("string"==typeof t||n instanceof Array)&&(n=t),n instanceof Array||(n=[n]),!n||0===n.length)throw console.log("%c'hasSubstring' needs at least one regex comparison. See "+e.description,"color: red;"),new Error;var r=t.nValues||!1,o=t.minValues||1,i=t.maxValues||n.length,s=function(t){var e=!1,s=0;return n.forEach(function(e,n,r){var o=t.value.match(new RegExp(e))||[];o.length>0&&(s+=1)}),r?e=s===r?!0:!1:s>=o&&i>=s&&(e=!0),e},a=e.gradebook.grade({callback:s,not:e.gradeOpposite,strictness:e.picky});e.onresult(a)})};Object.getOwnPropertyNames(a.prototype).filter(function(t){return-1===t.indexOf("_")&&"constructor"!==t});a.prototype._translateConfigToMethods=function(t){var e=this,n=[];t.nodes=t.nodes||t.elements;var r=Object.keys(t);return n=r.map(function(n){return function(){try{e[n](t[n])}catch(r){throw new Error("Method '"+n+"' did not execute. "+r)}}})},u.prototype.hasPassed=function(t){var e=null;t?(e=!0,this.testPassed=!0,(!this.flags.alwaysRun||this.flags.noRepeat)&&this.stopTest()):e=!1,this.element.setAttribute("test-passed",e),this.suite.checkTests()},u.prototype.runTest=function(){var e=this,n=this.flags.noRepeat||!1,r=(this.flags.alwaysRun||!1,this.flags.optional||!1,function(){new Promise(function(t,n){e.iwant.onresult=function(e){t(e)},e.iwant.queue.clear(),e.queueUp()}).then(function(t){var n=t.isCorrect||!1,r="";t.questions.forEach(function(t){r=r+" "+t.value}),e.hasPassed(n)})});n?r():this.gradeRunner=t.setInterval(r,1e3)},u.prototype.stopTest=function(){clearInterval(this.gradeRunner)},Object.defineProperties(c.prototype,{numberOfTests:{get:function(){return this.activeTests.length||0}},numberOfCorrectTests:{get:function(){var t=0;return this.activeTests.forEach(function(e){e.testPassed&&(t+=1)}),t}},numberOfCorrectOrOptionalTests:{get:function(){var t=0;return this.activeTests.forEach(function(e){(e.optional||e.testPassed)&&(t+=1)}),t}},numberOfOptionalTests:{get:function(){var t=0;this.activeTests.forEach(function(e){e.optional&&(t+=1)})}},allCorrect:{get:function(){var t=!1;return this.numberOfTests-this.numberOfCorrectOrOptionalTests<=0&&(t=!0),t}}}),c.prototype.createTest=function(t){function e(t){var e=document.createElement("active-test"),r=n.suite.element.shadowRoot.querySelector(".active-tests");return e.setAttribute("description",t.description),e.setAttribute("test-passed",t.testPassed),n.element=e,r.appendChild(e),e}var n=new u(t);n.suite=this,n.element=e({description:n.description,passed:n.testPassed,definition:n.definition}),this.activeTests.push(n),n.runTest()},c.prototype.checkTests=function(){var t=this.allCorrect;this.suitePassed=t,this.element.suitePassed=t,this.element.setAttribute("suite-passed",t)};var v={occupiedSuites:[],createSuite:function(t){var e=new c(t);return e.element=testResults.buildSuiteElement(e),this.occupiedSuites.push(e),e}};Object.defineProperties(v,{numberOfPassedSuites:{get:function(){var t=0;return this.occupiedSuites.forEach(function(e){e.suitePassed&&(t+=1)}),t}},numberOfSuites:{get:function(){return this.occupiedSuites.length}},allCorrect:{get:function(){var t=!1;return t=this.numberOfSuites===this.numberOfPassedSuites?!0:!1}}});var m=[],b={on:!1};return g.currentState=b,Object.observe(b,function(t){t[0].object.on&&t[0].oldValue===!1&&d()}),g.turnOn=f,g.turnOff=p,g.registerSuites=l,g}(window);window.dispatchEvent(new CustomEvent("GE-on",{detail:!0}));