var GE=function(t,e){"use strict";function n(t,e){if(!t)return[];e=e||document;var n=Array.prototype.slice.apply(e.querySelectorAll(t));return n}function r(t){if("number"==typeof t)return t;if("string"==typeof t)return t.match(/\d+/g)[0];throw new TypeError("Measurement needs to be passed a string or number.")}function i(){this._methods=[],this._flushing=!1,this._blocked=!1}function o(){this.id=parseInt(1e6*Math.random()),this.element=null,this.value=null,this.operation=null,this.children=[],this.index=null,this.correct=!1}function s(){this.questions=[],this.passed=!1}function a(t){this.target=null,this.gradebook=new s,this.operations=[],this.gradeOpposite=!1,this.picky=!1,this.queue=new i,this.description=t}function u(t){if(this.description=t.description,this.flags=t.flags||{},this.id=parseInt(1e6*Math.random()),this.testPassed=!1,this.debugData=[],this.gradeRunner=function(){},"string"!=typeof this.description)throw new TypeError("Every suite needs a description string.");if("object"!=typeof this.flags)throw new TypeError("If assigned, flags must be an object.");this.iwant=new a(this.description);var e=this;e.queueUp=function(t){var n=e.iwant._translateConfigToMethods(t);return function(){n.forEach(function(t){t()})}}(t.definition)}function c(t){var e=t.name,n=t.code,r=parseInt(1e6*Math.random());if("string"!=typeof e)throw new TypeError("Every suite needs a name string.");if("string"!=typeof n)throw new TypeError("Every suite needs a code string.");this.name=e,this.code=n,this.activeTests=[],this.id=r,this.suitePassed=!1}function h(t){function e(t){return r.createTest({description:t.description,definition:t.definition,flags:t.flags}),n}var n=this,r=m.createSuite(t);return{registerTest:e}}function f(t){try{b=JSON.parse(t)}catch(e){throw new TypeError("Invalid JSON format."+e)}y.on&&l()}function l(){b.forEach(function(t){var e=h({name:t.name,code:t.code});t.tests.forEach(function(t){e.registerTest({description:t.description,definition:t.definition,flags:t.flags})})})}function d(){y.on||(testWidget.buildWidget(),y.on=!0)}function p(){m.occupiedSuites.forEach(function(t){t.activeTests.forEach(function(t){t.stopTest()})}),m.occupiedSuites=[],testWidget.killWidget(),y.on=!1}function g(){m.occupiedSuites.forEach(function(t){t.getDebugData()})}var v={};Function.prototype.getBody=function(){var t=this.toString().match(/\{([\s\S]*)\}/m)[1];return t=t.replace(/([^"]+)|("[^"]+")/g,function(t,e,n){return e?e.replace(/\s/g,""):n}),t.replace(/^\s*\/\/.*$/gm,"")},i.prototype={add:function(t){this._methods.push(t),this._flushing||this._blocked||this.step()},clear:function(){this._flushing=!1,this._methods=[]},step:function(){function t(t){return new Promise(function(n,r){if(t)try{var i=t()}catch(o){e.block()}n(i)})}var e=this;this._flushing||(this._flushing=!0),this._blocked||t(this._methods.shift()).then(function(t){e._methods.length>0&&e.step()})},block:function(){this._blocked=!0},unblock:function(){this._blocked=!1,this.step()}},Object.defineProperties(o.prototype,{hasChildren:{get:function(){var t=!1;return this.children.length>0&&(t=!0),t}},hasValue:{get:function(){var t=!1;return null!==this.value&&this.value!==e&&(t=!0),t}},hasGrandkids:{get:function(){var t=!1;return t=this.children.some(function(t){return t.hasChildren})}}}),Object.defineProperties(s.prototype,{numberOfQuestions:{get:function(){return this.questions.length}},numberCorrectQuestions:{get:function(){var t=0;return this.questions.forEach(function(e){e.correct&&(t+=1)}),t}},allCorrect:{get:function(){var t=!1;return this.numberOfQuestions===this.numberCorrectQuestions&&this.numberOfQuestions>0&&(t=!0),t}},numberWrongQuestions:{get:function(){var t=0;return t=numberOfQuestions-numberCorrectQuestions}},report:{get:function(){return{isCorrect:this.passed,questions:this.questions}}}}),s.prototype.recordQuestion=function(t){t.correct=!1,this.questions.push(t)},s.prototype.reset=function(){this.questions=[],this.passed=!1},s.prototype.grade=function(t){var e,n,r;switch(e=t.strictness,n=t.not,r=t.callback,this.questions.forEach(function(t){t.correct=r(t),n&&(t.correct=!t.correct)}),e){case"someOf":this.numberCorrectQuestions<this.numberOfQuestions&&this.numberCorrectQuestions>0&&(this.passed=!0);break;case"onlyOneOf":1===this.numberCorrectQuestions&&(this.passed=!0);break;default:this.passed=this.allCorrect}return 0===this.numberOfQuestions&&n&&(this.passed=!this.passed),this.report},Object.defineProperties(a.prototype,{childPosition:{get:function(){var t=this;return this.queue.add(function(){t._runAgainstBottomTargets(function(t){var e=t.element,n=null,r=0;return Array.prototype.slice.apply(t.element.parentNode.children).forEach(function(t,i){"#text"===t.nodeName&&(r+=1),t===e&&(n=i-r)}),n})}),this}},count:{get:function(){var t=this;return this.queue.add(function(){t._registerOperation("count"),t._runAgainstNextToBottomTargets(function(e){var n=null;try{n=e.children.length}catch(r){throw console.log(r),t.onerror(),new Error}return n})}),this}},index:{get:function(){var t=this;return this.queue.add(function(){t._registerOperation("index"),t._runAgainstBottomTargets(function(t){return t.index})}),this}},innerHTML:{get:function(){var t=this;return this.queue.add(function(){t._registerOperation("innerHTML"),t._runAgainstBottomTargetElements(function(e){var n="";try{n=e.innerHTML}catch(r){throw console.log(r),t.onerror(),new Error}return n})}),this}},onlyOneOf:{get:function(){var t=this;return this.queue.add(function(){t.picky="onlyOneOf"}),this}},someOf:{get:function(){var t=this;return this.queue.add(function(){t.picky="someOf"}),this}},_targetIds:{get:function(){var t=[];return this._traverseTargets(function(e){t.push(e.id)}),t}},UAString:{get:function(){var t=this;return this.queue.add(function(){t._registerOperation("gatherElements"),t.target=new o,t._runAgainstTopTargetOnly(function(e){var n="";try{n=navigator.userAgent}catch(r){throw console.log("%cCan't find a user agent string. See '"+t.description+"'","color: red;"),t.onerror(),new Error}return n})}),this}}}),a.prototype.onresult=function(t){},a.prototype._registerOperation=function(t){this.operations.push(t),this.gradebook.reset()},a.prototype._traverseTargets=function(t){function e(t,n){n&&n(t),t.children.forEach(function(t,r,i){e(t,n)})}e(this.target,t)},a.prototype._runAgainstTopTargetOnly=function(t){var e=this;this.target.value=t(this.target),this.target.value?e.gradebook.recordQuestion(this.target):this.target.children.forEach(function(t){e.gradebook.recordQuestion(t)})},a.prototype._runAgainstBottomTargets=function(t){var e=this,n=this._targetIds;this._traverseTargets(function(r){!r.hasChildren&&n.indexOf(r.id)>-1&&(r.value=t(r),r.value?e.gradebook.recordQuestion(r):r.children.forEach(function(t){e.gradebook.recordQuestion(t)}))})},a.prototype._runAgainstBottomTargetElements=function(t){var e=this,n=this._targetIds;this._traverseTargets(function(r){!r.hasChildren&&n.indexOf(r.id)>-1&&(r.value=t(r.element),r.value?e.gradebook.recordQuestion(r):r.children.forEach(function(t){e.gradebook.recordQuestion(t)}))})},a.prototype._runAgainstNextToBottomTargets=function(t){var e=this;this._traverseTargets(function(n){n.hasChildren&&!n.hasGrandkids&&(n.value=t(n),n.value?e.gradebook.recordQuestion(n):n.children.forEach(function(t){e.gradebook.recordQuestion(t)}))})},a.prototype.theseElements=function(t){var e=this;return this.queue.add(function(){e._registerOperation("gatherElements"),e.target=new o,e._runAgainstTopTargetOnly(function(r){var i=n(t);t?i.length>0&&i.forEach(function(t,e,n){var i=new o;i.element=t,i.index=e,r.children.push(i)}):e.onerror("Cannot find elements without a selector.",!0)})}),this},a.prototype.nodes=a.prototype.theseElements,a.prototype.deepChildren=function(t){var e=this;this.queue.add(function(){e._registerOperation("gatherDeepChildElements"),e._runAgainstBottomTargets(function(r){var i=n(t,r.element);if(!t)throw e.onerror("Cannot find elements without a selector.",!0),new Error;r.element&&i.forEach(function(t,e){var n=new o;n.element=t,n.index=e,r.children.push(n)})})})},a.prototype.children=a.prototype.deepChildren,a.prototype.get=function(t){var e=this;switch(t){case"count":e.count;break;case"childPosition":e.childPosition;break;case"innerHTML":e.innerHTML;break;case"UAString":e.UAString;break;default:throw new Error("Cannot 'get': "+t+". Options include: 'count', 'childPosition', innerHTML', and 'UAString'.")}},a.prototype.limit=function(t){var e=this;switch(t){case 1:e.onlyOneOf;break;case"some":e.someOf;break;default:throw e.onerror("Illegal 'limit'. Options include: 1 or 'some'."),new Error}},a.prototype.cssProperty=function(e){var n=this;return this.queue.add(function(){n._registerOperation("cssProperty"),n._runAgainstBottomTargetElements(function(r){var i={},o=null;try{i=t.getComputedStyle(r),o=i[e]}catch(s){throw n.onerror("Cannot get CSS property: "+e+"."),new Error}return o})}),this},a.prototype.attribute=function(t){var e=this;return this.queue.add(function(){e._registerOperation("attribute"),e._runAgainstBottomTargetElements(function(n){var r=null;try{r=n.getAttribute(t)}catch(i){throw e.onerror("Cannot get attribute "+t+"."),new Error}return""===r&&(r=!0),r})}),this},a.prototype.absolutePosition=function(e){var n=this;return this.queue.add(function(){function r(e){var n=e.currentStyle||t.getComputedStyle(e,"");return n.display}n._registerOperation("absolutePosition");var i=function(){};switch(e){case"top":var i=function(t){var n=r(t),i=NaN;return"block"===n?i=t.offsetTop:"inline"===n&&(i=t.getBoundingClientRect()[e]),i};break;case"left":var i=function(t){var n=r(t),i=NaN;return"block"===n?i=t.offsetLeft:"inline"===n&&(i=t.getBoundingClientRect()[e]),i};break;case"bottom":var i=function(n){var i=r(n),o=NaN;return"block"===i?o=n.offsetTop+n.offsetHeight:"inline"===i&&(o=n.getBoundingClientRect()[e]),o===Math.max(document.documentElement.clientHeight,t.innerHeight||0)&&(o="max"),o};break;case"right":var i=function(n){var i=r(n),o=NaN;return"block"===i?o=n.offsetLeft+n.offsetWidth:"inline"===i&&(o=n.getBoundingClientRect()[e]),o===Math.max(document.documentElement.clientWidth,t.innerWidth||0)&&(o="max"),o};break;default:i=function(){return console.log("You didn't pick a side for absolutePosition! Options are 'top', 'left', 'bottom' and 'right'."),NaN}}n._runAgainstBottomTargetElements(function(t){var r=null;try{r=i(t)}catch(o){throw n.onerror("Cannot get absolute position of "+e+"."),new Error}return r})}),this},a.prototype.waitForEvent=function(e){var n=this;return n.queue.block(),t.addEventListener(e,function(t){n.queue.unblock(),n._runAgainstTopTargetOnly(function(e){return t.detail})}),this.queue.add(function(){n._registerOperation("gatherElements"),n.target=new o}),this},a.prototype.exists=function(t){var e=this;t===!1&&"boolean"==typeof t&&e.not(!0),this.queue.add(function(){var t=e.operations[e.operations.length-1],n=function(){};switch(t){case"gatherElements":n=function(t){var e=!1;return(t.children.length>0||t.element||t.value)&&(e=!0),e};break;case"gatherDeepChildElements":n=function(t){var e=!1;return t.element&&(e=!0),e};break;default:n=function(t){var e=!1;return(t.value||t.element)&&(e=!0),e}}var r=e.gradebook.grade({callback:n,not:e.gradeOpposite,strictness:e.picky});e.onresult(r)})},a.prototype.not=function(t){var e=this;"boolean"!=typeof t&&(t=!0),this.queue.add(function(){t&&(e.gradeOpposite=!0)})},a.prototype.equals=function(t){var e=this;this.queue.add(function(){var n,r;if("object"==typeof t?(n=t.expected,r=t.noStrict||!1):n=t,!n)throw e.onerror("'equals' needs a value."),new Error;var i=function(){};switch(r){case!0:i=function(t){return t.value==n};break;case!1:i=function(t){return t.value===n};break;default:i=function(t){return t.value===n}}var o=e.gradebook.grade({callback:i,not:e.gradeOpposite,strictness:e.picky});e.onresult(o)})},a.prototype.isGreaterThan=function(t){var e=this;this.queue.add(function(){var n=t.expected||t,i=t.orEqualTo||!1;if(!n)throw e.onerror("'isGreaterThan' needs a value."),new Error;var o=function(){};switch(i){case!0:o=function(t){var e=!1;return r(t.value)>=r(n)&&(e=!0),e};break;default:o=function(t){var e=!1;return r(t.value)>r(n)&&(e=!0),e}}var s=e.gradebook.grade({callback:o,not:e.gradeOpposite,strictness:e.picky});e.onresult(s)})},a.prototype.isLessThan=function(t){var e=this;this.queue.add(function(){var n=t.expected||t,i=t.orEqualTo||!1;if(!n)throw e.onerror("'isLessThan' needs a value."),new Error;var o=function(){};switch(i){case!0:o=function(t){var e=!1;return r(t.value)<=r(n)&&(e=!0),e};break;default:o=function(t){var e=!1;return r(t.value)<r(n)&&(e=!0),e}}var s=e.gradebook.grade({callback:o,not:e.gradeOpposite,strictness:e.picky});e.onresult(s)})},a.prototype.isInRange=function(t){var e=this;this.queue.add(function(){var n=r(t.lower),i=r(t.upper),o=t.lowerInclusive||!0,s=t.upperInclusive||!0;if(n>i){var a=n;n=i,i=a}if("number"!=typeof n||"number"!=typeof i)throw e.onerror("'isInRange' needs an upper and a lower value in its config object."),new Error;var u=function(){};switch(s){case!0:u=function(t){var e=!1;return r(t.value)<=r(i)&&(e=!0),e};break;default:u=function(t){var e=!1;return r(t.value)<r(i)&&(e=!0),e}}var c=function(){};switch(o){case!0:c=function(t){var e=!1;return r(t.value)>=r(n)&&(e=!0),e};break;default:c=function(t){var e=!1;return r(t.value)>r(n)&&(e=!0),e}}var h=function(t){var e=!1;return u(t)&&c(t)&&(e=!0),e},f=e.gradebook.grade({callback:h,not:e.gradeOpposite,strictness:e.picky});e.onresult(f)})},a.prototype.hasSubstring=function(t){var e=this;this.queue.add(function(){t=t||{};var n=t.expectedValues;if(("string"==typeof t||n instanceof Array)&&(n=t),n instanceof Array||(n=[n]),!n||0===n.length)throw e.onerror("'hasSubstring' needs at least one regex comparison."),new Error;var r=t.nValues||!1,i=t.minValues||1,o=t.maxValues||n.length,s=function(t){var e=!1,s=0;return n.forEach(function(e,n,r){var i=t.value.match(new RegExp(e))||[];i.length>0&&(s+=1)}),r?e=s===r?!0:!1:s>=i&&o>=s&&(e=!0),e},a=e.gradebook.grade({callback:s,not:e.gradeOpposite,strictness:e.picky});e.onresult(a)})};Object.getOwnPropertyNames(a.prototype).filter(function(t){return-1===t.indexOf("_")&&"constructor"!==t});a.prototype._translateConfigToMethods=function(t){var e=this,n=[];t.nodes=t.nodes||t.elements;var r=Object.keys(t);return n=r.map(function(n){return function(){try{e[n](t[n])}catch(r){throw new Error("Method '"+n+"' did not execute. "+r)}}})},u.prototype.hasPassed=function(t){var e=null;t?(e=!0,this.testPassed=!0,(!this.flags.alwaysRun||this.flags.noRepeat)&&this.stopTest()):e=!1,this.element.setAttribute("test-passed",e),this.suite.checkTests()},u.prototype.hasErred=function(){this.stopTest(),this.element.setAttribute("test-passed","error")},u.prototype.runTest=function(){var e=this,n=this.flags.noRepeat||!1,r=(this.flags.alwaysRun||!1,this.flags.optional||!1,function(){new Promise(function(t,n){e.debugData=[],e.iwant.onresult=function(e){t(e)},e.iwant.onerror=function(t,n){e.debugData.push(t),n||e.hasErred()},e.iwant.queue.clear(),e.queueUp()}).then(function(t){var n=t.isCorrect,r="";t.questions.forEach(function(t){r=r+" "+t.value}),e.hasPassed(n)})});n?r():(r(),this.gradeRunner=t.setInterval(r,1e3))},u.prototype.stopTest=function(){var t=this;clearInterval(t.gradeRunner)},Object.defineProperties(c.prototype,{numberOfTests:{get:function(){return this.activeTests.length||0}},numberOfCorrectTests:{get:function(){var t=0;return this.activeTests.forEach(function(e){e.testPassed&&(t+=1)}),t}},numberOfCorrectOrOptionalTests:{get:function(){var t=0;return this.activeTests.forEach(function(e){(e.optional||e.testPassed)&&(t+=1)}),t}},numberOfOptionalTests:{get:function(){var t=0;this.activeTests.forEach(function(e){e.optional&&(t+=1)})}},allCorrect:{get:function(){var t=!1;return this.numberOfTests-this.numberOfCorrectOrOptionalTests<=0&&(t=!0),t}}}),c.prototype.getDebugData=function(){this.activeTests.forEach(function(t){t.debugData.length>0&&console.log("%c"+t.description+" : "+t.debugData.join(" "),"color: red;")})},c.prototype.createTest=function(t){function e(t){var e=document.createElement("active-test"),r=n.suite.element.shadowRoot.querySelector(".active-tests");return e.setAttribute("description",t.description),e.setAttribute("test-passed",t.testPassed),n.element=e,r.appendChild(e),e}var n=new u(t);n.suite=this,n.element=e({description:n.description,passed:n.testPassed,definition:n.definition}),this.activeTests.push(n),n.runTest()},c.prototype.checkTests=function(){var t=this.allCorrect;this.suitePassed=t,this.element.suitePassed=t,this.element.setAttribute("suite-passed",t)};var m={occupiedSuites:[],createSuite:function(t){var e=new c(t);return e.element=testResults.buildSuiteElement(e),this.occupiedSuites.push(e),e}};Object.defineProperties(m,{numberOfPassedSuites:{get:function(){var t=0;return this.occupiedSuites.forEach(function(e){e.suitePassed&&(t+=1)}),t}},numberOfSuites:{get:function(){return this.occupiedSuites.length}},allCorrect:{get:function(){var t=!1;return t=this.numberOfSuites===this.numberOfPassedSuites?!0:!1}}});var b=[],y={on:!1};return v.currentState=y,Object.observe(y,function(t){t[0].object.on&&t[0].oldValue===!1&&l()}),v.debug=g,v.turnOn=d,v.turnOff=p,v.registerSuites=f,v}(window);window.dispatchEvent(new CustomEvent("GE-on",{detail:!0}));